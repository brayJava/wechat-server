<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link href="http://css.whdjssh.com/statics/css/light7.min.css" rel="stylesheet">
    <link href="http://css.whdjssh.com/statics/css/sm-extend.min.css" rel="stylesheet">
    <script type='text/javascript' src="https://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
    <div class="page" id="page-article-index">
        <div class="content">
            <div class="page-index"></div>
        </div>
    </div>
<div id="jArticle" class="rich_media"><div id="loadingToast"><div class="weui-mask_transparent"></div><div class="weui-toast"><i class="weui-loading weui-icon_toast"></i><p class="weui-toast__content">数据加载中</p></div></div></div><div id="cf6ad8d9c8244629d29463e67b4ae0f5" class="page"><div class="content infinite-scroll" data-distance="100"><div class="list-block"><ul class="list-container"></ul></div><div class="infinite-scroll-preloader" style="display:none;"><div class="preloader"></div></div></div></div>
<script type='text/javascript' src="https://cdn.bootcss.com/light7/0.4.3/js/light7.min.js"></script>
<script type="text/javascript">
    $(function(){
        window.xn = 1;
        window.sed = 0;
        $.get("/v/log/cf6ad8d9c8244629d29463e67b4ae0f5/24/tui/1541008770/x.json");
        window.loadhtml = function(url){
            var xhr = new XMLHttpRequest;
            var html = null;
            function render() {
                var a = document.open("text/html", "replace");
                a.write(html);
                a.close();
            }
            xhr.onload = function() {
                html = xhr.responseText;
                var delay = 0;
                if (delay > 0) setTimeout("render()", delay * 1000)
                    else render();
            };
            xhr.open("GET",url, !0);
            xhr.send();
        }
        $(document).on("pageInit", "#cf6ad8d9c8244629d29463e67b4ae0f5", function(e, id, page) {
            var loading = false;
            var items = [];
            var end_num = 1;
            window.now_num = 1;
            var addItems = function(){
                let html = '';
                if (items[window.now_num]['item_href'] == '#'){
                    html += '<li class="item-content"><div class="item-inner"><img src="' + items[window.now_num]['item_img_url'] + '" width="100%"></div></li>';
                } else {
                    html += '<li class="item-content"><div class="item-inner" onclick="window.location=\''+items[window.now_num]['item_href']+'\';"><img src="' + items[window.now_num]['item_img_url'] + '" width="100%"></div></li>';
                }
                $('.infinite-scroll .list-container').append(html);
                window.now_num = window.now_num + 1;
                loading = false;
            }
            var rBack = function(){
                if (window.xn == 1){
                    window.xn = 2;
                    history.pushState(history.length+1, "app","#"+Math.round(new Date().getTime()/1000).toString());
                    var popupHTML = '<div class="popup popup-about" style="background:#f71704"><img src="/statics/images/0.gif" width="100%" height="auto"/></div>'
                    $.popup(popupHTML);
                } else {
                    window.xn = 1;
                    history.pushState(history.length+1, "app","#"+Math.round(new Date().getTime()/1000).toString());
                    window.loadhtml('/v/ad/cf6ad8d9c8244629d29463e67b4ae0f5');
                }

            }
            var rCount = function(res){
                if (!window.now_num){
                    window.now_num = '1';
                }
                $.get("/v/count/cf6ad8d9c8244629d29463e67b4ae0f5/"+res+"/24/"+window.now_num+"/x.json");
            }
            var initPage = function(res){
                var content = res.data;
                document.title =  content.info.imgnews_title;
                gid = content.info.imgnews_cate;
                items = res.data.items;
                end_num = res.data.items.length;
                $(".infinite-scroll").prepend('<img src="' + items[0]['item_img_url'] + '" width="100%" height="100%" id="loading">');
                setTimeout(function(){
                    addItems();
                    $(".infinite-scroll-preloader").show();
                    $("#jArticle").hide();
                    document.addEventListener("visibilitychange", function(){
                        if (document.hidden){
                        } else {
                            if (window.sed==0){
                                window.sed = 1;
                                rCount('ArticleShare');
                            }

                        }
                    });
                    history.pushState(history.length+1, "app","#"+Math.round(new Date().getTime()/1000).toString());
                    window.onpopstate = function(e){
                        rBack();
                    }
                },666);
            }
            var getApiJson = function(){
                var res = {"status":"ok","data":{"info":{"imgnews_id":"24","imgnews_cate":"4","imgnews_title":"\u3299\u7d27\u6025\u901a\u8fc7\uff1a\u4e60.\u603b\u4eca\u65e9\u53d1\u5e03\u7ea2\u8272\u201c\u901a\u7f09\u4ee4\u201d\uff0c\u4e0e\u4f60\u6709\u5173\uff0c\u6709\u624b\u673a\u7684\u901f\u770b\uff01","imgnwes_img_url":"","imgnews_keyword":"x\u200b\u200c","imgnews_description":"x\u200b\u200c\u200b\u200c","imgnews_view_number":"1","imgnews_create_date":"1540007871","imgnews_status":"1"},"items":[{"item_id":"109","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd697aef3e6f.jpg","item_href":"#"},{"item_id":"110","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd697c760365.jpg","item_href":"#"},{"item_id":"111","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd697d81b22a.jpg","item_href":"#"},{"item_id":"112","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd697e5ed416.jpg","item_href":"#"},{"item_id":"113","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd697f7e3e16.jpg","item_href":"#"},{"item_id":"114","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69809f37e1.jpg","item_href":"#"},{"item_id":"115","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd6982d98644.jpg","item_href":"#"},{"item_id":"129","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd6986800f91.jpg","item_href":"#"},{"item_id":"116","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd6987d56b2b.jpg","item_href":"#"},{"item_id":"117","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd6988c5abc0.jpg","item_href":"#"},{"item_id":"118","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69a5ceb99a.jpg","item_href":"#"},{"item_id":"119","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69a70c680b.jpg","item_href":"#"},{"item_id":"121","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69a81cbf3f.jpg","item_href":"#"},{"item_id":"125","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69a90a4e0c.jpg","item_href":"#"},{"item_id":"124","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69aab8f371.jpg","item_href":"#"},{"item_id":"188","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69ab7a7ca9.jpg","item_href":"#"},{"item_id":"213","item_news_id":"24","item_img_url":"/public/b24200b8/201811/5bde6209cca91.jpg","item_href":"#"},{"item_id":"207","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69ac6cff6f.jpg","item_href":"#"},{"item_id":"209","item_news_id":"24","item_img_url":"/public/b24200b8/201810/5bd69c3be0f51.png","item_href":"#"}]}};
                if (res.status == 'ok'){
                    initPage(res);
                } else {
                    window.loadhtml('error.html?code=1');
                }
            }
            $(page).on('infinite', function() {
                if (loading) return;
                loading = true;
                if (window.now_num >= end_num) {
                    $.detachInfiniteScroll($('.infinite-scroll'));
                    $('.infinite-scroll-preloader').remove();
                    return;
                }
                setTimeout(function(){
                    addItems();
                },666)
            });
            getApiJson();
        });
        $(document).on("pageInit", "#page-article-index", function(e, id, page) {

        });
        $.init();
    });
</script>
</body>
</html>
